(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{196:function(t,e,a){"use strict";a.r(e);var r=a(6),s=Object(r.a)({},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"mongodb"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mongodb","aria-hidden":"true"}},[t._v("#")]),t._v(" MongoDb")]),t._v(" "),a("p",[t._v("前提：")]),t._v(" "),a("ol",[a("li",[t._v("进入 mongo docker")]),t._v(" "),a("li",[a("code",[t._v("mongo")]),t._v(" 命令进入 mongo 的命令操作界面")])]),t._v(" "),a("h2",{attrs:{id:"基本操作"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#基本操作","aria-hidden":"true"}},[t._v("#")]),t._v(" 基本操作")]),t._v(" "),a("ul",[a("li",[t._v("查看数据库命令")])]),t._v(" "),a("div",{staticClass:"language-mongo extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("dbs\n")])])]),a("ul",[a("li",[t._v("创建数据库, 切换数据库，没有数据库时候创建数据库")])]),t._v(" "),a("div",{staticClass:"language-mongo extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("use DATABASE_NAME\n")])])]),a("ul",[a("li",[t._v("删除数据库")])]),t._v(" "),a("div",{staticClass:"language-mongo extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("db.dropDatabase()\n")])])]),a("ul",[a("li",[t._v("创建 collection, 类似 mysql 中的table")])]),t._v(" "),a("div",{staticClass:"language-mongo extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('db.createCollection("table_name")\n')])])]),a("ul",[a("li",[t._v("向 collection 中插入数据")])]),t._v(" "),a("div",{staticClass:"language-mongo extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('db.table_name.insert({"name": "alex", "age": 12})\n')])])]),a("ul",[a("li",[t._v("查看当前数据库中有哪些 collection")])]),t._v(" "),a("div",{staticClass:"language-mongo extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("show tables\nshow collections\n")])])]),a("ul",[a("li",[t._v("删除 collection")])]),t._v(" "),a("div",{staticClass:"language-mongo extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("db.table_name.drop()\n")])])]),a("h2",{attrs:{id:"创建集合"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建集合","aria-hidden":"true"}},[t._v("#")]),t._v(" 创建集合")]),t._v(" "),a("div",{staticClass:"language-mongo extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("db.createCollection(name, options)\n")])])]),a("ul",[a("li",[t._v("name: 要创建的集合名称")]),t._v(" "),a("li",[t._v("options: 可选参数, 指定有关内存大小及索引的选项")])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("字段")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("类型")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("描述")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("capped")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("布尔")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("（可选）如果为 true，则创建固定集合。固定集合是指有着固定大小的集合，当达到最大值时，它会自动覆盖最早的文档。当该值为 true 时，必须指定 size 参数。")])]),t._v(" "),a("tr",[a("td",[t._v("autoIndexId")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("布尔")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("（可选）如为 true，自动在 _id 字段创建索引。默认为 false。")])]),t._v(" "),a("tr",[a("td",[t._v("size")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("数值")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("（可选）为固定集合指定一个最大值，以千字节计（KB）。如果 capped 为 true，也需要指定该字段。")])]),t._v(" "),a("tr",[a("td",[t._v("max")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("数值")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("（可选）指定固定集合中包含文档的最大数量。")])])])]),t._v(" "),a("ul",[a("li",[t._v("创建固定集合 mycol，整个集合空间大小 6142800 KB, 文档最大个数为 10000 个。")])]),t._v(" "),a("div",{staticClass:"language-mongo extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('db.createCollection("mycol", { capped : true, autoIndexId : true, size : 6142800, max : 10000 } )\n')])])]),a("h2",{attrs:{id:"插入文档"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#插入文档","aria-hidden":"true"}},[t._v("#")]),t._v(" 插入文档")]),t._v(" "),a("div",{staticClass:"language-MongoDb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("db.col.insert({title: 'MongoDB 教程',\n    description: 'MongoDB 是一个 Nosql 数据库',\n    by: '菜鸟教程',\n    url: 'http://www.runoob.com',\n    tags: ['mongodb', 'database', 'NoSQL'],\n    likes: 100\n})\n\ndb.col.find()\n")])])]),a("h2",{attrs:{id:"更新文档"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#更新文档","aria-hidden":"true"}},[t._v("#")]),t._v(" 更新文档")]),t._v(" "),a("div",{staticClass:"language-mongo extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("db.collection.update(\n   <query>,\n   <update>,\n   {\n     upsert: <boolean>,\n     multi: <boolean>,\n     writeConcern: <document>\n   }\n)\n")])])]),a("p",[t._v("query : update的查询条件，类似sql update查询内where后面的。\nupdate : update的对象和一些更新的操作符（如$,$inc...）等，也可以理解为sql update查询内set后面的\nupsert : 可选，这个参数的意思是，如果不存在update的记录，是否插入objNew,true为插入，默认是false，不插入。\nmulti : 可选，mongodb 默认是false,只更新找到的第一条记录，如果这个参数为true,就把按条件查出来多条记录全部更新。\nwriteConcern :可选，抛出异常的级别。")]),t._v(" "),a("ul",[a("li",[t._v("更新命令-相同的数据每次只可以修改一条记录")])]),t._v(" "),a("div",{staticClass:"language-mongo extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("db.col.update({'title':'MongoDB 教程'},{$set:{'title':'MongoDB'}})\n")])])]),a("ul",[a("li",[t._v("更新命令修改多行")])]),t._v(" "),a("div",{staticClass:"language-mongo extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("db.col.update({'title':'MongoDB 教程'},{$set:{'title':'MongoDB'}}, {multi: true})\n")])])]),a("ul",[a("li",[t._v("save() 传入替换已有的文档")])]),t._v(" "),a("p",[t._v("document : 文档数据。\nwriteConcern :可选，抛出异常的级别。")]),t._v(" "),a("div",{staticClass:"language-mongo extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("db.collection.save(\n   <document>,\n   {\n     writeConcern: <document>\n   }\n)\n")])])]),a("p",[t._v('修改 _id = ObjectId("56064f89ade2f21f36b03136") 的数据')]),t._v(" "),a("div",{staticClass:"language-mongo extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('db.col.find().pretty()\n{\n        "_id" : ObjectId("56064f89ade2f21f36b03136"),\n        "title" : "MongoDB",\n        "description" : "MongoDB 是一个 Nosql 数据库",\n        "by" : "Runoob",\n        "url" : "http://www.runoob.com",\n        "tags" : [\n                "mongodb",\n                "NoSQL"\n        ],\n        "likes" : 110\n}\n')])])]),a("ul",[a("li",[t._v("格式化查找 collection 中的数据")])]),t._v(" "),a("div",{staticClass:"language-mongo extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("db.col.find().pretty()\n")])])]),a("h2",{attrs:{id:"更多跟新示例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#更多跟新示例","aria-hidden":"true"}},[t._v("#")]),t._v(" 更多跟新示例")]),t._v(" "),a("div",{staticClass:"language-mongo extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('更多实例\n只更新第一条记录：\n\ndb.col.update( { "count" : { $gt : 1 } } , { $set : { "test2" : "OK"} } );\n全部更新：\n\ndb.col.update( { "count" : { $gt : 3 } } , { $set : { "test2" : "OK"} },false,true );\n只添加第一条：\n\ndb.col.update( { "count" : { $gt : 4 } } , { $set : { "test5" : "OK"} },true,false );\n全部添加进去:\n\ndb.col.update( { "count" : { $gt : 5 } } , { $set : { "test5" : "OK"} },true,true );\n全部更新：\n\ndb.col.update( { "count" : { $gt : 15 } } , { $inc : { "count" : 1} },false,true );\n只更新第一条记录：\n\ndb.col.update( { "count" : { $gt : 10 } } , { $inc : { "count" : 1} },false,false );\n')])])]),a("h2",{attrs:{id:"mongodb-删除文档"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mongodb-删除文档","aria-hidden":"true"}},[t._v("#")]),t._v(" MongoDB 删除文档")]),t._v(" "),a("ul",[a("li",[t._v("删除所有符合条件的数据")])]),t._v(" "),a("div",{staticClass:"language-mongo extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('db.col.remove({"title":"MongoDB"})\n')])])]),a("ul",[a("li",[t._v("删除一条符合条件的数据")])]),t._v(" "),a("div",{staticClass:"language-mongo extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('db.col.remove({"title":"MongoDB"}, 1)\n')])])]),a("ul",[a("li",[t._v("删除所有数据")])]),t._v(" "),a("div",{staticClass:"language-mongo extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("db.col.remove({})\ndb.col.find().pretty()\n")])])]),a("h2",{attrs:{id:"查询文档"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查询文档","aria-hidden":"true"}},[t._v("#")]),t._v(" 查询文档")]),t._v(" "),a("ul",[a("li",[t._v("query ：可选，使用查询操作符指定查询条件")]),t._v(" "),a("li",[t._v("projection ：可选，使用投影操作符指定返回的键。查询时返回文档中所有键值， 只需省略该参数即可（默认省略）。")])]),t._v(" "),a("div",{staticClass:"language-mongo extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("db.collection.find(query, projection)\n")])])]),a("h3",{attrs:{id:"where"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#where","aria-hidden":"true"}},[t._v("#")]),t._v(" where")]),t._v(" "),a("div",{staticClass:"language-mongo extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("db.col.find({key1:value1, key2:value2}).pretty()\n")])])]),a("table",[a("thead",[a("tr",[a("th",[t._v("操作")]),t._v(" "),a("th",[t._v("格式")]),t._v(" "),a("th",[t._v("范例")]),t._v(" "),a("th",[t._v("RDBMS中的类似语句")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("等于")]),t._v(" "),a("td",[t._v("{key:value}")]),t._v(" "),a("td",[t._v('db.col.find({"by":"菜鸟教程"}).pretty()')]),t._v(" "),a("td",[t._v("where by = '菜鸟教程'")])]),t._v(" "),a("tr",[a("td",[t._v("小于")]),t._v(" "),a("td",[t._v("{key:{$lt:value}}")]),t._v(" "),a("td",[t._v('db.col.find({"likes":{$lt:50}}).pretty()')]),t._v(" "),a("td",[t._v("where likes < 50")])]),t._v(" "),a("tr",[a("td",[t._v("小于或等于")]),t._v(" "),a("td",[t._v("{key:{$lte:value}}")]),t._v(" "),a("td",[t._v('db.col.find({"likes":{$lte:50}}).pretty()')]),t._v(" "),a("td",[t._v("where likes <= 50")])]),t._v(" "),a("tr",[a("td",[t._v("大于")]),t._v(" "),a("td",[t._v("{key:{$gt:value}}")]),t._v(" "),a("td",[t._v('db.col.find({"likes":{$gt:50}}).pretty()')]),t._v(" "),a("td",[t._v("where likes > 50")])]),t._v(" "),a("tr",[a("td",[t._v("大于或等于")]),t._v(" "),a("td",[t._v("{key:{$gte:value}}")]),t._v(" "),a("td",[t._v('db.col.find({"likes":{$gte:50}}).pretty()')]),t._v(" "),a("td",[t._v("where likes >= 50")])]),t._v(" "),a("tr",[a("td",[t._v("不等于")]),t._v(" "),a("td",[t._v("{key:{$ne:value}}")]),t._v(" "),a("td",[t._v('db.col.find({"likes":{$ne:50}}).pretty()')]),t._v(" "),a("td",[t._v("where likes != 50")])])])]),t._v(" "),a("h3",{attrs:{id:"where-and"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#where-and","aria-hidden":"true"}},[t._v("#")]),t._v(" where and")]),t._v(" "),a("div",{staticClass:"language-mongo extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('db.col.find({key1:value1, key2:value2}).pretty()\ndb.col.find({"by":"菜鸟教程", "title":"MongoDB 教程"}).pretty()\n')])])]),a("h3",{attrs:{id:"where-or"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#where-or","aria-hidden":"true"}},[t._v("#")]),t._v(" where or")]),t._v(" "),a("div",{staticClass:"language-mongo extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('db.col.find(\n   {\n      $or: [\n         {key1: value1}, {key2:value2}\n      ]\n   }\n).pretty()\ndb.col.find({$or:[{"by":"菜鸟教程"},{"title": "MongoDB 教程"}]}).pretty()\n')])])]),a("h3",{attrs:{id:"where-or-and-and"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#where-or-and-and","aria-hidden":"true"}},[t._v("#")]),t._v(" where or and and")]),t._v(" "),a("div",{staticClass:"language-mongo extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('db.col.find({"likes": {$gt:50}, $or: [{"by": "菜鸟教程"},{"title": "MongoDB 教程"}]}).pretty()\n')])])]),a("h2",{attrs:{id:"type-操作符号"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#type-操作符号","aria-hidden":"true"}},[t._v("#")]),t._v(" $type 操作符号")]),t._v(" "),a("ul",[a("li",[t._v("type 有很多类型； 1-Double, 2-string")]),t._v(" "),a("li",[t._v("其他判断 "),a("a",{attrs:{href:"https://www.runoob.com/mongodb/mongodb-operators-type.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("type 操作符号"),a("OutboundLink")],1)])]),t._v(" "),a("div",{staticClass:"language-mongo extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('db.col.find({"title" : {$type : 2}})\n或\ndb.col.find({"title" : {$type : \'string\'}})\n')])])]),a("h2",{attrs:{id:"limit-and-skip"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#limit-and-skip","aria-hidden":"true"}},[t._v("#")]),t._v(" limit and skip")]),t._v(" "),a("ul",[a("li",[t._v("limit: 限制查询数量")]),t._v(" "),a("li",[t._v("skip: 跳过多少条数据")])]),t._v(" "),a("h3",{attrs:{id:"limit"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#limit","aria-hidden":"true"}},[t._v("#")]),t._v(" limit")]),t._v(" "),a("div",{staticClass:"language-MongoDb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('db.col.find({},{"title":1,_id:0}).limit(2)\n')])])]),a("h3",{attrs:{id:"skip"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#skip","aria-hidden":"true"}},[t._v("#")]),t._v(" skip")]),t._v(" "),a("div",{staticClass:"language-mongo extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('db.col.find({},{"title":1,_id:0}).limit(1).skip(1)\n')])])]),a("h2",{attrs:{id:"sort-排序"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sort-排序","aria-hidden":"true"}},[t._v("#")]),t._v(" sort 排序")]),t._v(" "),a("ul",[a("li",[t._v("1 为升序")]),t._v(" "),a("li",[t._v("-1 为降序")])]),t._v(" "),a("div",{staticClass:"language-mongo extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("db.COLLECTION_NAME.find().sort({KEY:1})\n")])])]),a("h2",{attrs:{id:"索引"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#索引","aria-hidden":"true"}},[t._v("#")]),t._v(" 索引")]),t._v(" "),a("ul",[a("li",[t._v("目的：极大的提高查询效率。")]),t._v(" "),a("li",[t._v("原因：数据库可以根据索引，整理数据(排序、红黑树、B树、B+树 等)")]),t._v(" "),a("li",[t._v("以下将 col 表中的 title 升序排列，description 降序排列(复合索引)")]),t._v(" "),a("li",[t._v("background:true, 在后台创建索引，防止创建索引的过程中，阻塞其他数据库操作，当然还有其他的参数")]),t._v(" "),a("li",[a("a",{attrs:{href:"https://www.runoob.com/mongodb/mongodb-indexing.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("其他索引参数"),a("OutboundLink")],1)])]),t._v(" "),a("div",{staticClass:"language-mongo extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v(' db.col.createIndex({"title":1,"description":-1}, {"background": true})\n')])])]),a("h2",{attrs:{id:"聚合"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#聚合","aria-hidden":"true"}},[t._v("#")]),t._v(" 聚合")]),t._v(" "),a("ul",[a("li",[t._v("MongoDB中聚合(aggregate)主要用于处理数据(诸如统计平均值,求和等)，并返回计算后的数据结果。有点类似sql语句中的 count(*)。")])]),t._v(" "),a("div",{staticClass:"language-mongo extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("db.COLLECTION_NAME.aggregate(AGGREGATE_OPERATION)\n")])])]),a("ul",[a("li",[t._v("现在我们通过以上集合计算每个作者所写的文章数，使用aggregate()计算结果如下：")])]),t._v(" "),a("div",{staticClass:"language-mongo extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("{\n   _id: ObjectId(7df78ad8902c)\n   title: 'MongoDB Overview', \n   description: 'MongoDB is no sql database',\n   by_user: 'runoob.com',\n   url: 'http://www.runoob.com',\n   tags: ['mongodb', 'database', 'NoSQL'],\n   likes: 100\n},\n{\n   _id: ObjectId(7df78ad8902d)\n   title: 'NoSQL Overview', \n   description: 'No sql database is very fast',\n   by_user: 'runoob.com',\n   url: 'http://www.runoob.com',\n   tags: ['mongodb', 'database', 'NoSQL'],\n   likes: 10\n},\n{\n   _id: ObjectId(7df78ad8902e)\n   title: 'Neo4j Overview', \n   description: 'Neo4j is no sql database',\n   by_user: 'Neo4j',\n   url: 'http://www.neo4j.com',\n   tags: ['neo4j', 'database', 'NoSQL'],\n   likes: 750\n}\n\ndb.mycol.aggregate([{$group : {_id : \"$by_user\", num_tutorial : {$sum : 1}}}])\n{\n   \"result\" : [\n      {\n         \"_id\" : \"runoob.com\",\n         \"num_tutorial\" : 2\n      },\n      {\n         \"_id\" : \"Neo4j\",\n         \"num_tutorial\" : 1\n      }\n   ],\n   \"ok\" : 1\n}\n")])])]),a("h3",{attrs:{id:"其他表达式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#其他表达式","aria-hidden":"true"}},[t._v("#")]),t._v(" 其他表达式")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("表达式")]),t._v(" "),a("th",[t._v("描述")]),t._v(" "),a("th",[t._v("实例")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("$sum")]),t._v(" "),a("td",[t._v("计算总和。")]),t._v(" "),a("td",[t._v('db.mycol.aggregate([{$group : {_id : "$by_user", num_tutorial : {$sum : "$likes"}}}])')])]),t._v(" "),a("tr",[a("td",[t._v("$avg")]),t._v(" "),a("td",[t._v("计算平均值")]),t._v(" "),a("td",[t._v('db.mycol.aggregate([{$group : {_id : "$by_user", num_tutorial : {$avg : "$likes"}}}])')])]),t._v(" "),a("tr",[a("td",[t._v("$min")]),t._v(" "),a("td",[t._v("获取集合中所有文档对应值得最小值。")]),t._v(" "),a("td",[t._v('db.mycol.aggregate([{$group : {_id : "$by_user", num_tutorial : {$min : "$likes"}}}])')])]),t._v(" "),a("tr",[a("td",[t._v("$max")]),t._v(" "),a("td",[t._v("获取集合中所有文档对应值得最大值。")]),t._v(" "),a("td",[t._v('db.mycol.aggregate([{$group : {_id : "$by_user", num_tutorial : {$max : "$likes"}}}])')])]),t._v(" "),a("tr",[a("td",[t._v("$push")]),t._v(" "),a("td",[t._v("在结果文档中插入值到一个数组中。")]),t._v(" "),a("td",[t._v('db.mycol.aggregate([{$group : {_id : "$by_user", url : {$push: "$url"}}}])')])]),t._v(" "),a("tr",[a("td",[t._v("$addToSet")]),t._v(" "),a("td",[t._v("在结果文档中插入值到一个数组中，但不创建副本。")]),t._v(" "),a("td",[t._v('db.mycol.aggregate([{$group : {_id : "$by_user", url : {$addToSet : "$url"}}}])')])]),t._v(" "),a("tr",[a("td",[t._v("$first")]),t._v(" "),a("td",[t._v("根据资源文档的排序获取第一个文档数据。")]),t._v(" "),a("td",[t._v('db.mycol.aggregate([{$group : {_id : "$by_user", first_url : {$first : "$url"}}}])')])]),t._v(" "),a("tr",[a("td",[t._v("$last")]),t._v(" "),a("td",[t._v("根据资源文档的排序获取最后一个文档数据")]),t._v(" "),a("td",[t._v('db.mycol.aggregate([{$group : {_id : "$by_user", last_url : {$last : "$url"}}}])')])]),t._v(" "),a("tr",[a("td",[t._v("$match")]),t._v(" "),a("td",[t._v("使用MongoDB的标准查询操作。")]),t._v(" "),a("td",[t._v("--")])]),t._v(" "),a("tr",[a("td",[t._v("$limit")]),t._v(" "),a("td",[t._v("用来限制MongoDB聚合管道返回的文档数。")]),t._v(" "),a("td",[t._v("--")])]),t._v(" "),a("tr",[a("td",[t._v("$skip")]),t._v(" "),a("td",[t._v("在聚合管道中跳过指定数量的文档，并返回余下的文档。")]),t._v(" "),a("td",[t._v("--")])]),t._v(" "),a("tr",[a("td",[t._v("$unwind")]),t._v(" "),a("td",[t._v("将文档中的某一个数组类型字段拆分成多条，每条包含数组中的一个值。")]),t._v(" "),a("td",[t._v("--")])]),t._v(" "),a("tr",[a("td",[t._v("$group")]),t._v(" "),a("td",[t._v("将集合中的文档分组，可用于统计结果。")]),t._v(" "),a("td",[t._v("--")])]),t._v(" "),a("tr",[a("td",[t._v("$sort")]),t._v(" "),a("td",[t._v("将输入文档排序后输出。")]),t._v(" "),a("td",[t._v("--")])]),t._v(" "),a("tr",[a("td",[t._v("$geoNear")]),t._v(" "),a("td",[t._v("输出接近某一地理位置的有序文档。")]),t._v(" "),a("td",[t._v("--")])])])]),t._v(" "),a("h3",{attrs:{id:"aggregate、-match-代替-find"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#aggregate、-match-代替-find","aria-hidden":"true"}},[t._v("#")]),t._v(" aggregate、$match 代替 find()")]),t._v(" "),a("div",{staticClass:"language-mongo extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('db.col.aggregate([{$match:{"age":{$gt:12}}}]).pretty()\n')])])]),a("h3",{attrs:{id:"查询数量"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查询数量","aria-hidden":"true"}},[t._v("#")]),t._v(" 查询数量")]),t._v(" "),a("div",{staticClass:"language-mongo extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("db.module2.find().count()\n")])])]),a("h2",{attrs:{id:"通道-注意：-有待写更多的-demo"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#通道-注意：-有待写更多的-demo","aria-hidden":"true"}},[t._v("#")]),t._v(" 通道(注意： 有待写更多的 demo)")]),t._v(" "),a("p",[t._v("管道在Unix和Linux中一般用于将当前命令的输出结果作为下一个命令的参数。\nMongoDB的聚合管道将MongoDB文档在一个管道处理完毕后将结果传递给下一个管道处理。管道操作是可以重复的。\n表达式：处理输入文档并输出。表达式是无状态的，只能用于计算当前聚合管道的文档，不能处理其它的文档。")]),t._v(" "),a("p",[t._v("$project：修改输入文档的结构。可以用来重命名、增加或删除域，也可以用于创建计算结果以及嵌套文档。\n$match：用于过滤数据，只输出符合条件的文档。$match使用MongoDB的标准查询操作。\n$limit：用来限制MongoDB聚合管道返回的文档数。\n$skip：在聚合管道中跳过指定数量的文档，并返回余下的文档。\n$unwind：将文档中的某一个数组类型字段拆分成多条，每条包含数组中的一个值。\n$group：将集合中的文档分组，可用于统计结果。\n$sort：将输入文档排序后输出。\n$geoNear：输出接近某一地理位置的有序文档。")]),t._v(" "),a("div",{staticClass:"language-mongo extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("db.article.aggregate(\n    { $project : {\n        title : 1 ,\n        author : 1 ,\n    }}\n );\n")])])])])},[],!1,null,null,null);e.default=s.exports}}]);