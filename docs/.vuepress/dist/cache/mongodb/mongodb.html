<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>MongoDb | Touch</title>
    <meta name="description" content="Just playing around">
    
    
    <link rel="preload" href="/blog/assets/css/0.styles.e521e81d.css" as="style"><link rel="preload" href="/blog/assets/js/app.7b12281e.js" as="script"><link rel="preload" href="/blog/assets/js/12.e6ed112c.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.0e8bcb13.js"><link rel="prefetch" href="/blog/assets/js/11.c1d8fb0a.js"><link rel="prefetch" href="/blog/assets/js/13.5ddda774.js"><link rel="prefetch" href="/blog/assets/js/14.bad9018c.js"><link rel="prefetch" href="/blog/assets/js/15.c51d215b.js"><link rel="prefetch" href="/blog/assets/js/16.7a975866.js"><link rel="prefetch" href="/blog/assets/js/17.c3a3e119.js"><link rel="prefetch" href="/blog/assets/js/18.17981196.js"><link rel="prefetch" href="/blog/assets/js/19.3b21fd10.js"><link rel="prefetch" href="/blog/assets/js/2.b7ae8144.js"><link rel="prefetch" href="/blog/assets/js/20.37ceae63.js"><link rel="prefetch" href="/blog/assets/js/21.343b9532.js"><link rel="prefetch" href="/blog/assets/js/22.1575650c.js"><link rel="prefetch" href="/blog/assets/js/23.2b921ccf.js"><link rel="prefetch" href="/blog/assets/js/24.a40443df.js"><link rel="prefetch" href="/blog/assets/js/25.9adf3472.js"><link rel="prefetch" href="/blog/assets/js/26.77261034.js"><link rel="prefetch" href="/blog/assets/js/27.76cefc29.js"><link rel="prefetch" href="/blog/assets/js/28.bf2319e9.js"><link rel="prefetch" href="/blog/assets/js/29.983720cf.js"><link rel="prefetch" href="/blog/assets/js/3.cbd07064.js"><link rel="prefetch" href="/blog/assets/js/30.904b8a1d.js"><link rel="prefetch" href="/blog/assets/js/31.7c5a8f81.js"><link rel="prefetch" href="/blog/assets/js/32.2d45f8e1.js"><link rel="prefetch" href="/blog/assets/js/33.4161607d.js"><link rel="prefetch" href="/blog/assets/js/34.f4afe3ca.js"><link rel="prefetch" href="/blog/assets/js/35.280ad5b3.js"><link rel="prefetch" href="/blog/assets/js/36.522acfdb.js"><link rel="prefetch" href="/blog/assets/js/37.7231eab0.js"><link rel="prefetch" href="/blog/assets/js/38.f55e9343.js"><link rel="prefetch" href="/blog/assets/js/4.4d6142ab.js"><link rel="prefetch" href="/blog/assets/js/5.98787390.js"><link rel="prefetch" href="/blog/assets/js/6.120535e7.js"><link rel="prefetch" href="/blog/assets/js/7.97f6a704.js"><link rel="prefetch" href="/blog/assets/js/8.116c1654.js"><link rel="prefetch" href="/blog/assets/js/9.67c68ced.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.e521e81d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">Touch</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">后台</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/peddle_self/dashboard/golang.html" class="nav-link">golang</a></li><li class="dropdown-item"><!----> <a href="/blog/peddle_self/dashboard/redis.html" class="nav-link">redis</a></li><li class="dropdown-item"><!----> <a href="/blog/peddle_self/dashboard/mogodb.html" class="nav-link">mogodb</a></li><li class="dropdown-item"><!----> <a href="/blog/peddle_self/dashboard/database.html" class="nav-link">mysql</a></li><li class="dropdown-item"><!----> <a href="/blog/peddle_self/dashboard/web.html" class="nav-link">web</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">mogodb</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/cache/mongodb/mongodb.html" class="nav-link router-link-exact-active router-link-active">MongoDB</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">redis</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/cache/redis/redis.html" class="nav-link">Redis</a></li><li class="dropdown-item"><!----> <a href="/blog/cache/redis/leveldb.html" class="nav-link">LevelDB</a></li><li class="dropdown-item"><!----> <a href="/blog/cache/redis/rocksdb.html" class="nav-link">RocksDB</a></li></ul></div></div><div class="nav-item"><a href="/blog/peddle_self/production/document.html" class="nav-link">数据库表</a></div><div class="nav-item"><a href="/blog/weex/weex.html" class="nav-link">weex</a></div><div class="nav-item"><a href="/blog/server/server.html" class="nav-link">服务器</a></div><div class="nav-item"><a href="/blog/vue/primary/primary.html" class="nav-link">vue入门</a></div><div class="nav-item"><a href="/blog/arithmetic/home.html" class="nav-link">算法</a></div><div class="nav-item"><a href="/blog/javaoc/javaoc.html" class="nav-link">j2objc</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">issue</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/issue/vue.html" class="nav-link">vue</a></li><li class="dropdown-item"><!----> <a href="/blog/issue/golang.html" class="nav-link">golang</a></li><li class="dropdown-item"><!----> <a href="/blog/issue/mysql.html" class="nav-link">mysql</a></li></ul></div></div><div class="nav-item"><a href="/blog/golang/learning.html" class="nav-link">golang</a></div><div class="nav-item"><a href="/blog/webpack/learning.html" class="nav-link">webpack</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">后台</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/peddle_self/dashboard/golang.html" class="nav-link">golang</a></li><li class="dropdown-item"><!----> <a href="/blog/peddle_self/dashboard/redis.html" class="nav-link">redis</a></li><li class="dropdown-item"><!----> <a href="/blog/peddle_self/dashboard/mogodb.html" class="nav-link">mogodb</a></li><li class="dropdown-item"><!----> <a href="/blog/peddle_self/dashboard/database.html" class="nav-link">mysql</a></li><li class="dropdown-item"><!----> <a href="/blog/peddle_self/dashboard/web.html" class="nav-link">web</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">mogodb</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/cache/mongodb/mongodb.html" class="nav-link router-link-exact-active router-link-active">MongoDB</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">redis</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/cache/redis/redis.html" class="nav-link">Redis</a></li><li class="dropdown-item"><!----> <a href="/blog/cache/redis/leveldb.html" class="nav-link">LevelDB</a></li><li class="dropdown-item"><!----> <a href="/blog/cache/redis/rocksdb.html" class="nav-link">RocksDB</a></li></ul></div></div><div class="nav-item"><a href="/blog/peddle_self/production/document.html" class="nav-link">数据库表</a></div><div class="nav-item"><a href="/blog/weex/weex.html" class="nav-link">weex</a></div><div class="nav-item"><a href="/blog/server/server.html" class="nav-link">服务器</a></div><div class="nav-item"><a href="/blog/vue/primary/primary.html" class="nav-link">vue入门</a></div><div class="nav-item"><a href="/blog/arithmetic/home.html" class="nav-link">算法</a></div><div class="nav-item"><a href="/blog/javaoc/javaoc.html" class="nav-link">j2objc</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">issue</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/issue/vue.html" class="nav-link">vue</a></li><li class="dropdown-item"><!----> <a href="/blog/issue/golang.html" class="nav-link">golang</a></li><li class="dropdown-item"><!----> <a href="/blog/issue/mysql.html" class="nav-link">mysql</a></li></ul></div></div><div class="nav-item"><a href="/blog/golang/learning.html" class="nav-link">golang</a></div><div class="nav-item"><a href="/blog/webpack/learning.html" class="nav-link">webpack</a></div> <!----></nav>  <!----> </div> <div class="page"> <div class="content"><h1 id="mongodb"><a href="#mongodb" aria-hidden="true" class="header-anchor">#</a> MongoDb</h1> <p>前提：</p> <ol><li>进入 mongo docker</li> <li><code>mongo</code> 命令进入 mongo 的命令操作界面</li></ol> <h2 id="基本操作"><a href="#基本操作" aria-hidden="true" class="header-anchor">#</a> 基本操作</h2> <ul><li>查看数据库命令</li></ul> <div class="language-mongo extra-class"><pre class="language-text"><code>dbs
</code></pre></div><ul><li>创建数据库, 切换数据库，没有数据库时候创建数据库</li></ul> <div class="language-mongo extra-class"><pre class="language-text"><code>use DATABASE_NAME
</code></pre></div><ul><li>删除数据库</li></ul> <div class="language-mongo extra-class"><pre class="language-text"><code>db.dropDatabase()
</code></pre></div><ul><li>创建 collection, 类似 mysql 中的table</li></ul> <div class="language-mongo extra-class"><pre class="language-text"><code>db.createCollection(&quot;table_name&quot;)
</code></pre></div><ul><li>向 collection 中插入数据</li></ul> <div class="language-mongo extra-class"><pre class="language-text"><code>db.table_name.insert({&quot;name&quot;: &quot;alex&quot;, &quot;age&quot;: 12})
</code></pre></div><ul><li>查看当前数据库中有哪些 collection</li></ul> <div class="language-mongo extra-class"><pre class="language-text"><code>show tables
show collections
</code></pre></div><ul><li>删除 collection</li></ul> <div class="language-mongo extra-class"><pre class="language-text"><code>db.table_name.drop()
</code></pre></div><h2 id="创建集合"><a href="#创建集合" aria-hidden="true" class="header-anchor">#</a> 创建集合</h2> <div class="language-mongo extra-class"><pre class="language-text"><code>db.createCollection(name, options)
</code></pre></div><ul><li>name: 要创建的集合名称</li> <li>options: 可选参数, 指定有关内存大小及索引的选项</li></ul> <table><thead><tr><th>字段</th> <th style="text-align:center">类型</th> <th style="text-align:left">描述</th></tr></thead> <tbody><tr><td>capped</td> <td style="text-align:center">布尔</td> <td style="text-align:left">（可选）如果为 true，则创建固定集合。固定集合是指有着固定大小的集合，当达到最大值时，它会自动覆盖最早的文档。当该值为 true 时，必须指定 size 参数。</td></tr> <tr><td>autoIndexId</td> <td style="text-align:center">布尔</td> <td style="text-align:left">（可选）如为 true，自动在 _id 字段创建索引。默认为 false。</td></tr> <tr><td>size</td> <td style="text-align:center">数值</td> <td style="text-align:left">（可选）为固定集合指定一个最大值，以千字节计（KB）。如果 capped 为 true，也需要指定该字段。</td></tr> <tr><td>max</td> <td style="text-align:center">数值</td> <td style="text-align:left">（可选）指定固定集合中包含文档的最大数量。</td></tr></tbody></table> <ul><li>创建固定集合 mycol，整个集合空间大小 6142800 KB, 文档最大个数为 10000 个。</li></ul> <div class="language-mongo extra-class"><pre class="language-text"><code>db.createCollection(&quot;mycol&quot;, { capped : true, autoIndexId : true, size : 6142800, max : 10000 } )
</code></pre></div><h2 id="插入文档"><a href="#插入文档" aria-hidden="true" class="header-anchor">#</a> 插入文档</h2> <div class="language-MongoDb extra-class"><pre class="language-text"><code>db.col.insert({title: 'MongoDB 教程',
    description: 'MongoDB 是一个 Nosql 数据库',
    by: '菜鸟教程',
    url: 'http://www.runoob.com',
    tags: ['mongodb', 'database', 'NoSQL'],
    likes: 100
})

db.col.find()
</code></pre></div><h2 id="更新文档"><a href="#更新文档" aria-hidden="true" class="header-anchor">#</a> 更新文档</h2> <div class="language-mongo extra-class"><pre class="language-text"><code>db.collection.update(
   &lt;query&gt;,
   &lt;update&gt;,
   {
     upsert: &lt;boolean&gt;,
     multi: &lt;boolean&gt;,
     writeConcern: &lt;document&gt;
   }
)
</code></pre></div><p>query : update的查询条件，类似sql update查询内where后面的。
update : update的对象和一些更新的操作符（如$,$inc...）等，也可以理解为sql update查询内set后面的
upsert : 可选，这个参数的意思是，如果不存在update的记录，是否插入objNew,true为插入，默认是false，不插入。
multi : 可选，mongodb 默认是false,只更新找到的第一条记录，如果这个参数为true,就把按条件查出来多条记录全部更新。
writeConcern :可选，抛出异常的级别。</p> <ul><li>更新命令-相同的数据每次只可以修改一条记录</li></ul> <div class="language-mongo extra-class"><pre class="language-text"><code>db.col.update({'title':'MongoDB 教程'},{$set:{'title':'MongoDB'}})
</code></pre></div><ul><li>更新命令修改多行</li></ul> <div class="language-mongo extra-class"><pre class="language-text"><code>db.col.update({'title':'MongoDB 教程'},{$set:{'title':'MongoDB'}}, {multi: true})
</code></pre></div><ul><li>save() 传入替换已有的文档</li></ul> <p>document : 文档数据。
writeConcern :可选，抛出异常的级别。</p> <div class="language-mongo extra-class"><pre class="language-text"><code>db.collection.save(
   &lt;document&gt;,
   {
     writeConcern: &lt;document&gt;
   }
)
</code></pre></div><p>修改 _id = ObjectId(&quot;56064f89ade2f21f36b03136&quot;) 的数据</p> <div class="language-mongo extra-class"><pre class="language-text"><code>db.col.find().pretty()
{
        &quot;_id&quot; : ObjectId(&quot;56064f89ade2f21f36b03136&quot;),
        &quot;title&quot; : &quot;MongoDB&quot;,
        &quot;description&quot; : &quot;MongoDB 是一个 Nosql 数据库&quot;,
        &quot;by&quot; : &quot;Runoob&quot;,
        &quot;url&quot; : &quot;http://www.runoob.com&quot;,
        &quot;tags&quot; : [
                &quot;mongodb&quot;,
                &quot;NoSQL&quot;
        ],
        &quot;likes&quot; : 110
}
</code></pre></div><ul><li>格式化查找 collection 中的数据</li></ul> <div class="language-mongo extra-class"><pre class="language-text"><code>db.col.find().pretty()
</code></pre></div><h2 id="更多跟新示例"><a href="#更多跟新示例" aria-hidden="true" class="header-anchor">#</a> 更多跟新示例</h2> <div class="language-mongo extra-class"><pre class="language-text"><code>更多实例
只更新第一条记录：

db.col.update( { &quot;count&quot; : { $gt : 1 } } , { $set : { &quot;test2&quot; : &quot;OK&quot;} } );
全部更新：

db.col.update( { &quot;count&quot; : { $gt : 3 } } , { $set : { &quot;test2&quot; : &quot;OK&quot;} },false,true );
只添加第一条：

db.col.update( { &quot;count&quot; : { $gt : 4 } } , { $set : { &quot;test5&quot; : &quot;OK&quot;} },true,false );
全部添加进去:

db.col.update( { &quot;count&quot; : { $gt : 5 } } , { $set : { &quot;test5&quot; : &quot;OK&quot;} },true,true );
全部更新：

db.col.update( { &quot;count&quot; : { $gt : 15 } } , { $inc : { &quot;count&quot; : 1} },false,true );
只更新第一条记录：

db.col.update( { &quot;count&quot; : { $gt : 10 } } , { $inc : { &quot;count&quot; : 1} },false,false );
</code></pre></div><h2 id="mongodb-删除文档"><a href="#mongodb-删除文档" aria-hidden="true" class="header-anchor">#</a> MongoDB 删除文档</h2> <ul><li>删除所有符合条件的数据</li></ul> <div class="language-mongo extra-class"><pre class="language-text"><code>db.col.remove({&quot;title&quot;:&quot;MongoDB&quot;})
</code></pre></div><ul><li>删除一条符合条件的数据</li></ul> <div class="language-mongo extra-class"><pre class="language-text"><code>db.col.remove({&quot;title&quot;:&quot;MongoDB&quot;}, 1)
</code></pre></div><ul><li>删除所有数据</li></ul> <div class="language-mongo extra-class"><pre class="language-text"><code>db.col.remove({})
db.col.find().pretty()
</code></pre></div><h2 id="查询文档"><a href="#查询文档" aria-hidden="true" class="header-anchor">#</a> 查询文档</h2> <ul><li>query ：可选，使用查询操作符指定查询条件</li> <li>projection ：可选，使用投影操作符指定返回的键。查询时返回文档中所有键值， 只需省略该参数即可（默认省略）。</li></ul> <div class="language-mongo extra-class"><pre class="language-text"><code>db.collection.find(query, projection)
</code></pre></div><h3 id="where"><a href="#where" aria-hidden="true" class="header-anchor">#</a> where</h3> <div class="language-mongo extra-class"><pre class="language-text"><code>db.col.find({key1:value1, key2:value2}).pretty()
</code></pre></div><table><thead><tr><th>操作</th> <th>格式</th> <th>范例</th> <th>RDBMS中的类似语句</th></tr></thead> <tbody><tr><td>等于</td> <td>{key:value}</td> <td>db.col.find({&quot;by&quot;:&quot;菜鸟教程&quot;}).pretty()</td> <td>where by = '菜鸟教程'</td></tr> <tr><td>小于</td> <td>{key:{$lt:value}}</td> <td>db.col.find({&quot;likes&quot;:{$lt:50}}).pretty()</td> <td>where likes &lt; 50</td></tr> <tr><td>小于或等于</td> <td>{key:{$lte:value}}</td> <td>db.col.find({&quot;likes&quot;:{$lte:50}}).pretty()</td> <td>where likes &lt;= 50</td></tr> <tr><td>大于</td> <td>{key:{$gt:value}}</td> <td>db.col.find({&quot;likes&quot;:{$gt:50}}).pretty()</td> <td>where likes &gt; 50</td></tr> <tr><td>大于或等于</td> <td>{key:{$gte:value}}</td> <td>db.col.find({&quot;likes&quot;:{$gte:50}}).pretty()</td> <td>where likes &gt;= 50</td></tr> <tr><td>不等于</td> <td>{key:{$ne:value}}</td> <td>db.col.find({&quot;likes&quot;:{$ne:50}}).pretty()</td> <td>where likes != 50</td></tr></tbody></table> <h3 id="where-and"><a href="#where-and" aria-hidden="true" class="header-anchor">#</a> where and</h3> <div class="language-mongo extra-class"><pre class="language-text"><code>db.col.find({key1:value1, key2:value2}).pretty()
db.col.find({&quot;by&quot;:&quot;菜鸟教程&quot;, &quot;title&quot;:&quot;MongoDB 教程&quot;}).pretty()
</code></pre></div><h3 id="where-or"><a href="#where-or" aria-hidden="true" class="header-anchor">#</a> where or</h3> <div class="language-mongo extra-class"><pre class="language-text"><code>db.col.find(
   {
      $or: [
         {key1: value1}, {key2:value2}
      ]
   }
).pretty()
db.col.find({$or:[{&quot;by&quot;:&quot;菜鸟教程&quot;},{&quot;title&quot;: &quot;MongoDB 教程&quot;}]}).pretty()
</code></pre></div><h3 id="where-or-and-and"><a href="#where-or-and-and" aria-hidden="true" class="header-anchor">#</a> where or and and</h3> <div class="language-mongo extra-class"><pre class="language-text"><code>db.col.find({&quot;likes&quot;: {$gt:50}, $or: [{&quot;by&quot;: &quot;菜鸟教程&quot;},{&quot;title&quot;: &quot;MongoDB 教程&quot;}]}).pretty()
</code></pre></div></div> <div class="page-edit"><!----> <!----></div> <!----> </div> <!----></div></div>
    <script src="/blog/assets/js/app.7b12281e.js" defer></script><script src="/blog/assets/js/12.e6ed112c.js" defer></script>
  </body>
</html>
